define(["jquery"],function(){$.fn.identalk_lightbox=function(e){function a(){$('<div class="mask hide"></div>').css({width:$(document).width(),height:$(document).height()}).appendTo("body")}function f(){$(".orange-wrap").hide().remove(),$(".mask").fadeOut(300,function(){$(this).remove()}),u.afterClose!==undefined&&u.afterClose()}function l(e,t){return e.css(t).animate({opacity:"show",top:"+=15"},300)}function c(){var e=$(".orange-outer");$(".orange-wrap").css({height:e.height(),width:e.width()})}function h(e){$this=$(e),a();var t=$(".mask").css("z-index");u.beforeLoad!==undefined&&u.beforeLoad(e);if(u.type=="img"){var n='<img src="'+$this.attr("href")+'" />';o.empty().append(n)}if(u.type=="iframe")var c=$('<iframe  src="'+$this.attr("href")+'"></iframe>');else o.empty().append(u.content);i=i.append(s).append(o);var h=r.append(i),p,d,v,m;switch(u.type){case"iframe":h.find(".orange-content").html(c),c.load(function(){v=$(window).height()/2-u.height/2,m=$(window).width()/2-u.width/2;var e={height:u.height,width:u.width,"overflow-x":"hidden","overflow-y":"auto"};l(c,e);var n={"z-index":t+1,top:v+$(document).scrollTop()-15,left:m};l(h,n)});break;case"img":v=$(window).height()/2-$(".orange-wrap").height()/2,m=$(window).width()/2-$(".orange-wrap").width()/2;break;default:v=$(window).height()/2-u.height/2,m=$(window).width()/2-u.width/2,u.autowidth?d="auto":d=u.width,u.autoheight?p="auto":p=u.height;var g={height:p,width:d,top:v+$(document).scrollTop()-15,left:m,"z-index":t+1};l(h,g)}u.fixed&&h.css({position:"fixed",top:200}),$.browser.msie&&h.addClass("orange-wrap-ie"),h.appendTo("body"),u.afterLoad!==undefined&&u.afterLoad(e),$(".orange-wrap").length>1&&$(".orange-wrap").eq(0).remove(),$(".orange-close").click(function(){f()}),$(".mask").click(function(){f()})}var t={width:650,height:400,content:"lightbox",animate:!1,autoheight:!1,autowidth:!1,fixed:!1,open:!1},n="<div class='orange-wrap hide'><div class='orange-outer'><a href='javascript:;' class='orange-close'>X</a><div class='orange-content'>{{content}}</div></div></div>",r=$('<div class="orange-wrap"></div>'),i=$('<div class="orange-outer"></div>'),s=$('<div class="orange-header"><a href="javascript:;" class="orange-close">X</a></div>'),o=$('<div class="orange-content"></div>'),u=$.extend({},t,e);return this.each(function(){var e=$(this);u.open?h(this):e.unbind("click").click(function(e){e.preventDefault();if(u.beforeOpen!==undefined&&u.beforeOpen()){u.beforeOpen();return}h(this)})}),this}});