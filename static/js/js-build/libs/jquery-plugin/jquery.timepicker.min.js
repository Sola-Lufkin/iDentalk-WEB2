(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t){var n=t.data("timepicker-settings"),r=t.data("timepicker-list");r&&r.length&&(r.remove(),t.data("timepicker-list",!1)),r=e("<ul />",{tabindex:-1,"class":"ui-timepicker-list"}),n.className&&r.addClass(n.className),r.css({display:"none",position:"absolute"}),(n.minTime!==null||n.durationTime!==null)&&n.showDuration&&r.addClass("ui-timepicker-with-duration");var i=n.durationTime!==null?n.durationTime:n.minTime,s=n.minTime!==null?n.minTime:0,u=n.maxTime!==null?n.maxTime:s+d-1;u<=s&&(u+=d);for(var a=s;a<=u;a+=n.step*60){var h=a%d,p=e("<li />");p.data("time",h),p.text(c(h,n.timeFormat));if((n.minTime!==null||n.durationTime!==null)&&n.showDuration){var v=e("<span />");v.addClass("ui-timepicker-duration"),v.text(" ("+l(a-i)+")"),p.append(v)}r.append(p)}r.data("timepicker-input",t),t.data("timepicker-list",r);var m=n.appendTo;typeof m=="string"?m=e(m):typeof m=="function"&&(m=m(t)),m.append(r),o(t,r),r.on("click","li",function(n){t.addClass("ui-timepicker-hideme"),t[0].focus(),r.find("li").removeClass("ui-timepicker-selected"),e(this).addClass("ui-timepicker-selected"),f(t),r.hide()})}function n(){var e=new Date(0),t=e.getTimezoneOffset()*6e4;e.setHours(0),e.setMinutes(0),e.setSeconds(0);var n=e.getTimezoneOffset()*6e4;return new Date(e.valueOf()-n+t)}function r(t){"ontouchstart"in document?e("body").on("touchstart.ui-timepicker",i):(e("body").on("mousedown.ui-timepicker",i),t.closeOnWindowScroll&&e(window).on("scroll.ui-timepicker",i))}function i(t){var n=e(t.target),r=n.closest(".ui-timepicker-input");r.length===0&&n.closest(".ui-timepicker-list").length===0&&(g.hide(),e("body").unbind(".ui-timepicker"),e(window).unbind(".ui-timepicker"))}function s(t,n,r){if(!r&&r!==0)return!1;var i=t.data("timepicker-settings"),s=!1,o=i.step*30;return n.find("li").each(function(t,n){var i=e(n),u=i.data("time")-r;if(Math.abs(u)<o||u==o)return s=i,!1}),s}function o(e,t){var n=h(e.val()),r=s(e,t,n);r&&r.addClass("ui-timepicker-selected")}function u(){if(this.value==="")return;var t=e(this),n=h(this.value);if(n===null){t.trigger("timeFormatError");return}var r=t.data("timepicker-settings");r.minTime!==null&&n<r.minTime?t.trigger("timeRangeError"):r.maxTime!==null&&n>r.maxTime&&t.trigger("timeRangeError");if(r.forceRoundTime){var i=n%(r.step*60);i>=r.step*30?n+=r.step*60-i:n-=i}var s=c(n,r.timeFormat);t.val(s)}function a(t){var n=e(this),r=n.data("timepicker-list");if(!r||!r.is(":visible")){if(t.keyCode!=40)return!0;n.focus()}switch(t.keyCode){case 13:return f(n),g.hide.apply(this),t.preventDefault(),!1;case 38:var i=r.find(".ui-timepicker-selected");i.length?i.is(":first-child")||(i.removeClass("ui-timepicker-selected"),i.prev().addClass("ui-timepicker-selected"),i.prev().position().top<i.outerHeight()&&r.scrollTop(r.scrollTop()-i.outerHeight())):(r.children().each(function(t,n){if(e(n).position().top>0)return i=e(n),!1}),i.addClass("ui-timepicker-selected"));break;case 40:i=r.find(".ui-timepicker-selected"),i.length===0?(r.children().each(function(t,n){if(e(n).position().top>0)return i=e(n),!1}),i.addClass("ui-timepicker-selected")):i.is(":last-child")||(i.removeClass("ui-timepicker-selected"),i.next().addClass("ui-timepicker-selected"),i.next().position().top+2*i.outerHeight()>r.outerHeight()&&r.scrollTop(r.scrollTop()+i.outerHeight()));break;case 27:r.find("li").removeClass("ui-timepicker-selected"),r.hide();break;case 9:g.hide();break;case 16:case 17:case 18:case 19:case 20:case 33:case 34:case 35:case 36:case 37:case 39:case 45:return;default:r.find("li").removeClass("ui-timepicker-selected");return}}function f(e){var t=e.data("timepicker-settings"),n=e.data("timepicker-list"),r=null,i=n.find(".ui-timepicker-selected");i.length?r=i.data("time"):e.val()&&(r=h(e.val()),o(e,n));if(r!==null){var s=c(r,t.timeFormat);e.val(s)}e.trigger("change").trigger("changeTime")}function l(e){var t=Math.round(e/60),n;if(Math.abs(t)<60)n=[t,m.mins];else if(t==60)n=["1",m.hr];else{var r=(t/60).toFixed(1);m.decimal!="."&&(r=r.replace(".",m.decimal)),n=[r,m.hrs]}return n.join(" ")}function c(e,t){if(e===null)return;var n=new Date(p.valueOf()+e*1e3),r="",i,s;for(var o=0;o<t.length;o++){s=t.charAt(o);switch(s){case"a":r+=n.getHours()>11?"pm":"am";break;case"A":r+=n.getHours()>11?"PM":"AM";break;case"g":i=n.getHours()%12,r+=i===0?"12":i;break;case"G":r+=n.getHours();break;case"h":i=n.getHours()%12,i!==0&&i<10&&(i="0"+i),r+=i===0?"12":i;break;case"H":i=n.getHours(),r+=i>9?i:"0"+i;break;case"i":var u=n.getMinutes();r+=u>9?u:"0"+u;break;case"s":e=n.getSeconds(),r+=e>9?e:"0"+e;break;default:r+=s}}return r}function h(t){if(t==="")return null;if(t+0==t)return t;typeof t=="object"&&(t=t.getHours()+":"+t.getMinutes()+":"+t.getSeconds());var n=new Date(0),r;t.indexOf(":")===-1&&e.isNumeric(t.charAt(1))?r=/^([0-2][0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)/:r=/^(\d{1,2})(?::(\d{1,2}))?(?::(\d{1,2}))?\s*([pa]?)/;var i=t.toLowerCase().match(r);if(!i)return null;var s=parseInt(i[1]*1,10),o;i[4]?s==12?o=i[4]=="p"?12:0:o=s+(i[4]=="p"?12:0):o=s;var u=i[2]*1||0,a=i[3]*1||0;return o*3600+u*60+a}var p=n(),d=86400,v={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,timeFormat:"g:ia",scrollDefaultNow:!1,scrollDefaultTime:!1,selectOnBlur:!1,disableTouchKeyboard:!0,forceRoundTime:!1,appendTo:"body",closeOnWindowScroll:!0},m={decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},g={init:function(t){return this.each(function(){var n=e(this);if(n[0].tagName=="SELECT"){var r={type:"text",value:n.val()},i=n[0].attributes;for(var s=0;s<i.length;s++)r[i[s].nodeName]=i[s].nodeValue;var o=e("<input />",r);n.replaceWith(o),n=o}var f=e.extend({},v);t&&(f=e.extend(f,t)),f.minTime&&(f.minTime=h(f.minTime)),f.maxTime&&(f.maxTime=h(f.maxTime)),f.durationTime&&(f.durationTime=h(f.durationTime)),f.lang&&(m=e.extend(m,f.lang)),n.data("timepicker-settings",f),n.prop("autocomplete","off"),n.on("click.timepicker focus.timepicker",g.show),n.on("blur.timepicker",u),n.on("keydown.timepicker",a),n.addClass("ui-timepicker-input"),u.call(n.get(0))})},show:function(n){var i=e(this),o=i.data("timepicker-settings");"ontouchstart"in document&&o.disableTouchKeyboard&&i.blur();var u=i.data("timepicker-list");if(i.prop("readonly"))return;if(!u||u.length===0)t(i),u=i.data("timepicker-list");if(i.hasClass("ui-timepicker-hideme")){i.removeClass("ui-timepicker-hideme"),u.hide();return}if(u.is(":visible"))return;g.hide(),u.show(),i.offset().top+i.outerHeight(!0)+u.outerHeight()>e(window).height()+e(window).scrollTop()?u.offset({left:i.offset().left,top:i.offset().top-u.outerHeight()}):u.offset({left:i.offset().left,top:i.offset().top+i.outerHeight()});var a=u.find(".ui-timepicker-selected");a.length||(i.val()?a=s(i,u,h(i.val())):o.scrollDefaultNow?a=s(i,u,h(new Date)):o.scrollDefaultTime!==!1&&(a=s(i,u,h(o.scrollDefaultTime))));if(a&&a.length){var f=u.scrollTop()+a.position().top-a.outerHeight();u.scrollTop(f)}else u.scrollTop(0);r(o),i.trigger("showTimepicker")},hide:function(t){e(".ui-timepicker-list:visible").each(function(){var t=e(this),n=t.data("timepicker-input"),r=n.data("timepicker-settings");r&&r.selectOnBlur&&f(n),t.hide(),n.trigger("hideTimepicker")})},option:function(t,n){var r=e(this),i=r.data("timepicker-settings"),s=r.data("timepicker-list");if(typeof t=="object")i=e.extend(i,t);else if(typeof t=="string"&&typeof n!="undefined")i[t]=n;else if(typeof t=="string")return i[t];i.minTime&&(i.minTime=h(i.minTime)),i.maxTime&&(i.maxTime=h(i.maxTime)),i.durationTime&&(i.durationTime=h(i.durationTime)),r.data("timepicker-settings",i),s&&(s.remove(),r.data("timepicker-list",!1))},getSecondsFromMidnight:function(){return h(e(this).val())},getTime:function(){return new Date(p.valueOf()+h(e(this).val())*1e3)},setTime:function(t){var n=e(this),r=c(h(t),n.data("timepicker-settings").timeFormat);n.val(r)},remove:function(){var t=e(this);if(!t.hasClass("ui-timepicker-input"))return;t.removeAttr("autocomplete","off"),t.removeClass("ui-timepicker-input"),t.removeData("timepicker-settings"),t.off(".timepicker"),t.data("timepicker-list")&&t.data("timepicker-list").remove(),t.removeData("timepicker-list")}};e.fn.timepicker=function(t){if(g[t])return g[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return g.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timepicker")}});